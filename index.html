<html>
<head>
  <script src="http://cdn.binaryjs.com/0/binary.js"></script>
  <script>
    // Connect to Binary.js server
    var client = new BinaryClient('ws://10.0.1.13:9999');
    var lastFrame = null;
    // Received new stream from server!
    client.on('all', function() {
      console.log('[ STUFF IS HAPPENING ]', arguments);
    });

    client.on('stream', function(stream, meta){
      var tempcanvas = document.createElement('canvas');
      tempcanvas.height = 768;
      tempcanvas.width = 1024;
      var tempcontext = tempcanvas.getContext('2d');

      stream.on('data', function(data){
        // 4096 byte
        console.log('[ DATA ARRIVE ] ', data);
        var bytes = new Uint8Array(data),
            image = tempcontext.createImageData(tempcanvas.width, tempcanvas.height);
        debugger;
        var page = 0, i = 0, k = 0, totalPages = image.length;
        for (page; page < totalPages; page++) {
            i = 0;
            for (i; i < image[page].length; i++) {
              imgage[k] = image[page][i];
              k++;
            }
        }

        tempcontext.drawImage(image, 0, 0);
      });
      // stream.on('data', function(data){
      //   console.log('[ DATA ARRIVE ] ', data);
      //   var bytes = new Uint8Array(data),
      //       src = (window.URL || window.webkitURL).createObjectURL(new Blob(data)),
      //       img = new Image(src);

      //   tempcontext.putImageData(bytes, 0, 0);
      // });
      stream.on('close', function(){
        console.log('[ STREAM END ]')
        // // Display new data in browser!
        // var video = document.createElement("video");
        // video.src = (window.URL || window.webkitURL).createObjectURL(new Blob(parts));
        // document.body.innerHTML = "";
        // document.body.appendChild(video);
        // lastFrame = video;
      });
    });
  </script>
</head>
<body>
</body>
</html>
